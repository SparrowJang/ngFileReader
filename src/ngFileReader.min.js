/*! ngFileReader 0.0.2 | Copyright (c) 2014 sparrow.jang | MIT license*/
!function(a){"use strict";var b=a.module("ngFileReader",[]);b.directive("ngFileReader",function(){var b=function(a){return{multiple:void 0!=a.multiple}},c=function(a,b){var c=a.find("input");b.multiple&&c.attr("multiple",!0)},d={onSelected:function(a,b){a.onSelected({files:b})},onReadered:function(b,c){a.forEach(c,function(a){var c=b.readMethod;if(c){var d=new FileReader;d.addEventListener("loadend",function(c){b.onReaded({event:c,file:a}),b.$apply()}),d[c]&&d[c](a,b.readEncoding)}})}};return{scope:{onSelected:"&",onReaded:"&",readMethod:"=",readEncoding:"=",filereader:"@"},template:"<input type='file'/>",link:function(a,e,f){var g=b(f);if(void 0==window.File)e.fileReader({multiple:g.multiple,debugMode:f.debugMode,filereader:a.filereader});else{c(e,g);var h=function(a){a.preventDefault()};e.on("dragenter",h),e.on("dragover",h),e.on("drop",function(b){h(b);var c=b.originalEvent?b.originalEvent:b,e=c.dataTransfer.files;d.onSelected(a,e),d.onReadered(a,e)})}e.on("change",function(b){var c=b.target.files;d.onSelected(a,c),d.onReadered(a,c),e.find("input").val(""),a.$apply()})}}}),b.filter("fileSize",function(){return function(a,b){if(!a)return"";for(var c=["k","m","g","t"],d=a,e=-1;d>1024;){var d=d/1024;if(e++,1>d||3==e)break}return d.toFixed(b?b:1)+" "+(c[e]?c[e]:"")}})}(angular);